<html>
  <script>
var folderNames = [];

chrome.extension.onRequest.addListener(function(request, sender, sendResponse)
{
    if (request.type == "getprefs")
    {
        // Initialise the list of folder names for use on the preferences
        // dialogue if not yet initialised and they are available.
        if (folderNames.length == 0 &&
            request.folderNames.length > 0)
        {
            folderNames = request.folderNames;
        }

        sendResponse({
            ignoredTopics: localStorage.ignoredTopics,
            ignoredFolders: localStorage.ignoredFolders,
            collapseIgnoredTopics: localStorage.collapseIgnoredTopics
        });
    }
    else if (request.type == "setpref")
    {
        localStorage.setItem(request.name, request.value);
    }
});

chrome.tabs.onUpdated.addListener(function(tabId, changeInfo, tab)
{
    if (tab.url.indexOf("http://rllmukforum.com") == 0 ||
        tab.url.indexOf("http://www.rllmukforum.com") == 0)
    {
        chrome.pageAction.show(tabId);
    }
});
  </script>
</html>
